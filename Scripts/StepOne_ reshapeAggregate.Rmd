---
title: "Step one: reshape and create aggregate variables"
author: "K L Purves"
date: '`r format(Sys.time(), "%d %B, %Y")`'

output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: false
    number_sections: false
    highlight: monochrome
    theme: cerulean
code_folding: show

html_notebook:
  theme: cerulean
toc: yes
---

# Description
This script will reshape the data frame so that there are the correct number of trials per stimulus (12 each for CS plus and minus in acquisition, 2 for each stimulus in generalisation, 18 in extinction and  in return of fear). The total number of missed values per stimulus per phase will be recorded in the exclusion dataset. Finally aggregate scores (averages across stimuli across phases) will be created.

# Setup
This section will set up your environment ready to begin processing the data.


#### Clear global environment
```{r Clear global environment}
remove(list = ls())
```

#### load libraries 
This code block will check if you have the appropriate libraries installed. If you do not, it will download and install them for you. If you do, it will simply call them into your local library.

```{r Setup, libraries}

if(!require(reshape2)){
  install.packages("reshape2")
  library(reshape2)
}

if(!require(dplyr)){
  install.packages("dplyr")
  library(dplyr)
}

if(!require(tidyr)){
  install.packages("tidyr")
  library(tidyr)
}

if(!require(zoo)){
  install.packages("zoo")
  library(zoo)
}

if(!require(tibble)){
  install.packages("tibble")
  library(tibble)
}

```

#### select stage zero data, identify file path and file names

This block will ask you to find the *stage zero data* on your computer. it will use this information to identify the right path for the finished stage one data set

```{r get files and paths}

## file picker
filename_zero <- file.choose()

## get the path to the directory where we will save the finished dataset
save_path <- file.path(dirname(dirname(filename_zero)),"StageOne_datasets")

```

#### read in stage zero data


```{r read in data}

zero_data <- read.csv(filename_zero)

```

# normalise data according to CS plus ID

## acquisition and extinction

Use the CS plus ID column to correctly identify which shape was the CS plus and which was the CS minus. Allocate expectancy ratings accordingly. 



